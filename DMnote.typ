#set page(
  paper:"a4",
  margin:(top:2cm, bottom:2cm, left:2cm,right:2cm),
)
#set text(font:"SimSun",size:12pt)
#show heading.where(level:1):it => block(width:100%)[
  #set align(center)
  #set text(
    size:18pt,
    weight:"bold",
    // underline:line(
    //   stroke: red + 1pt,  
    //   cap: "round"        
    // )
  )
  #it.body
  // #box(fill:luma(94.9%, 74.1%),inset:2pt,it.body)
]
= 离散数学基础笔记（以模块划分）
#v(3em)
#show heading.where(level:2):it => block(width:100%)[
  #set align(center)
  #set text(
    size:16pt,
    weight:"bold",
  )
  #it.body
]
== 模块1：数论  
#v(2em)
#show heading.where(level:3):it => block(width:100%)[
  #set text(
    size:14pt,
    weight:"bold",
  )
  #it.body
]
=== 一·基本概念
#v(1em)

1.平凡因子；1和本身      

#h(1em)真因子

2.带余除法：$a=q b+r$ (其中$0<=r<|b|$)

3.最大公因子：$gcd(a,b)$

#h(1em)最小公倍数：$lcm(a,b)$

4.梅森素数：形如$M_n=2^n-1$的素数

5.$[a]_m$或$[a]$以及$Z_m$：$a$的模$m$等价类，$[a]_m = {b | b equiv a (mod m)}$，整数集Z在模m下的商集$Z_m$，例如$Z_5={[0],[1],[2],[3],[4]}$

6.一次同余方程：$a x equiv b (mod m)$，其中$a,b,m$为整数，$m>0$

7.a的模m逆元：$a^(-1)$，满足$a a^(-1) equiv 1 (mod m)$

8.欧拉函数：$phi(n)$，表示小于等于n且与n互素的正整数个数，注意$phi(1)=1$

9.-1和9公因数有{1，-1}，最大公因数为1，所以互质
#v(2em)
=== 二·公式定理
#v(1em)
1.算术基本定理：设$a>1$，则$a=p_1^r_1p_2^r_2...p_k^r_k$，其中$p_k$为互异的素数，$r_k$为正整数，则不
  
  考虑顺序时表示唯一

2.正因子个数：$d(n)=(r_1+1)(r_2+1)...(r_k+1)$

3.有无穷多个素数：$ lim_(n->oo) frac(pi(n),n/ln(n))  = 1 $或$ pi(n) ~ frac(n,ln(n)) $

4.埃拉托色尼筛法：见例2

5.辗转相除法（欧几里得算法）：$gcd(a,b)=gcd(b,a mod b)$

6.贝祖定理：若$a,b$不全为0，则存在$x,y$使得$gcd(a,b)=a x+b y$，其中$x,y$为整数

7.a,b互素的充要条件：存在整数x，y使得$x a+y b=1$

8.模运算的性质：
   - 若 $a equiv b (mod m),c equiv d(mod m)$，则 $a #sym.plus.minus c equiv b #sym.plus.minus d(mod m),a c equiv b d(mod m),a^k equiv b^k (mod m)$,其中k为自然数
   - 若 $d>=1$，则 $a equiv b (mod m) #sym.arrow.l.r.double d a equiv d b(mod d m)$
   - 若 $gcd(c,m)=1$，则 $a equiv b(mod m) #sym.arrow.l.r.double c a equiv c b(mod m)$

9.一次同余方程：$a x equiv b (mod m)$，其中$a,b,m$为整数，$m>0$，$gcd(a,m)=1$时有唯一解$x$，否则有解当且仅当$gcd(a,m)$整除$b$，此时解的个数为$gcd(a,m)$

10.$a^(-1)$存在 $#sym.arrow.l.r.double gcd(a,m)=1$，且若存在则唯一（a的任意两个模m逆都模m同余）
   
11.若n的素因子分解式 $n=p_1^alpha_1 p_2^alpha_2...p_k^alpha_k$，则 $phi(n)=n (1-frac(1,p_1)) (1-frac(1,p_2))...(1-frac(1,p_k))$

12.欧拉定理：若 $gcd(a,n)=1$，则 $a^phi(n) equiv 1 (mod n)$

13.费马小定理（可视为欧拉定理在质数情况的推论）：

- 若 $p$为素数，$a$为整数，且 $gcd(a,p)=1$，则 $a^(p-1) equiv 1 (mod p)$
- 若 $p$为素数，$a$为整数，则 $a^p equiv a (mod p)$
  - 计算 $a^(-1)$ 时的小推论：若 $p$ 为素数，则 $a^(-1) equiv a^(p-2)(mod p)$
#v(2em)
=== 三·精选例题
#v(1em)
1.$20!$的二进制表示从最低位起有多少个连续的0？

   解：$20! =2^18*3^8*5^4*7^2*11^1*13^1*17^1*19^1$，所以有18个连续的0。

2.求100以内的素数。

   解：$sqrt(100)=10$，10以内素数：2，3，5，7，用他们删所有能被他们整除的数，剩下的就是素数。

3.求168,300最大公因数，并表示成线性组合
   
   解：$168=2^3*3*7$，$300=2^2*3*5^2$，所以$gcd(168,300)=2^2*3=12$
    而$ 300=168+132 $
    $ 168=132+36 $
    $ 132=36*3+24 $
    $ 36=24+12 $
    $ 24=12*2+0 $

    则$12=36-24=36-(132-36*3)=...=9*168-5*300$

4.$3^455$的个位数是？

    解：
    法一：$3^1=3$，$3^2=9$，$3^3=27$，$3^4=81$，$3^5=243$，$3^6=729$，所以周期为4，余数为3，所以个位数是7。

    法二：设为$x$，则$3^455 equiv x(mod 10)$，又$3^4 equiv 1(mod 10)$，则$3^(4*113) equiv 1^113 (mod 10)$，又$3^3 equiv 7(mod 10)$，两式相乘可得$3^455 equiv 7(mod 10)$

5.解方程 $8 x equiv 4(mod 6)$

    解：$gcd(8,6)=2$，整除4，所以有2解，取模6等价类代表$-2,-1,0,1,2,3$，代入得$x$的解为$2,-1$，即 $x equiv 2 (mod 6)$ 或 $x equiv -1 (mod 6)$
  
  【错解】全部除以2

#v(2em)
=== 四.课后习题
#v(1em)
4.4 设 $a,b,c,d$ 均为正整数，下列叙述是否正确？是，证明；否，给反例

#h(2em) (1)若 $a|c,b|c$，则 $a b|c$

#h(2em) (2)若 $a|c,b|d$，则 $a b|c d$

#h(2em) (3)若 $a b|c$，则 $a|c$

#h(2em) (4)若 $a|b c$，则 $a|b$ 或 $a|c$

//#v(1em)
解：

(1) 错误，反例：$a=4,b=6,c=12$，则$4|12,6|12$，但$4*6=24$，所以不成立。

(2) 正确，设$c=k_1 a,d=k_2 b$，则$c d=k_1 k_2 a b$，所以$a b|c d$

(3) 正确，设$c=k a b$，则$a|c$是显然的

(4) 错误，反例：$a=6,b=2,c=3$，则$6|2*3=6$成立，但$6|2,6|3$都不成立。
#v(2em)
4.16 证明：$forall x,y,u,v in Z,gcd(a,b)<=gcd(x a+y b,u a+v b)$

证：令 $d=gcd(a,b)$

#h(2em)则 $d|a$且 $d|b$

#h(2em)则 $d|a x+b y$且 $d|a u+b v$

#h(2em)则 $d$ 为 $x a+y b,u a+v b$ 的公因子

#h(2em)故 $d<=gcd(x a+y b,u a+v b)$，得证
#v(2em)
4.34 下列叙述是否正确，是，证明之；否，举反例

#h(2em) (1)若 $a^2 equiv b^2(mod m)$，则 $a equiv b(mod m)$ 或 $a equiv -b(mod m)$

#h(2em) (2)若 $a equiv b(mod m)$，则 $a^2 equiv b^2(mod m)$

#h(2em) (3)若 $a^2 equiv b^2(mod m^2)$，则 $a equiv b(mod m)$

#h(2em) (4)若 $a equiv b(mod m n)$，则 $a equiv b(mod m)$ 且 $a equiv b(mod n)$

#h(2em) (5)若 $a equiv b(mod m)$ 且 $a equiv b(mod n)$，则 $a equiv b(mod m n)$

解：

(1) 错误，反例：$a=10,b=2,m=24$
    
(2) 正确，$a-b equiv 0(mod m)$，则 $(a-b)(a+b) equiv 0(mod m)$，得证

(3) 错误，反例：$a=5,b=3,m=4$

(4) 正确，由于 $a-b=k m n$，故 $a-b=k m or a-b=k n$，得证

(5) 错误，反例：$a=5,b=1,m=4,n=2$
#v(2em)
4.35 解下列一次同余方程

#h(2em) (1) $9 x equiv 3(mod 6)$

#h(2em) (2) $4 x equiv 3(mod 6)$

#h(2em) (3) $3 x equiv -1(mod 5)$

#h(2em) (4) $8 x equiv 2(mod 4)$

#h(2em) (5) $20 x equiv 12(mod 8)$

解：

(1) $gcd(9,6)=3,3|3$，有3解，取模6等价类 $-2,-1,0,1,2,3$，代入得 $x equiv -1(mod 6) or x equiv 1(mod 6) or x equiv 3(mod 6)$

(2) $gcd(4,6)=2,2 #sym.divides.not 3$，无解

(3) $gcd(3,5)=1,1|-1$，有1解，取模5等价类 $-2,-1,0,1,2$，代入得 $x equiv -2(mod 5)$

(4) $gcd(8,4)=4,4 #sym.divides.not 2$，无解

(5) $gcd(20,8)=4,4|12$，有4解，取模8等价类 $-3,-2,-1,0,1,2,3,4$，代入得 $x equiv -3(mod 8) or x equiv -1(mod 8) or x equiv 1(mod 8) or x equiv 3(mod 8)$
#v(2em)
4.37 对下列每一组a,m,是否有 $a^(-1)(mod m)$ ？

#h(2em) (1) $2,3$

#h(2em) (2) $8,12$

#h(2em) (3) $18,7$

#h(2em) (4) $12,21$

#h(2em) (5) $5,9$

#h(2em) (6) $-1,9$

解：

(1) $gcd(a,m)=1$，是，$3$ 是素数，由费马小定理的推论 $2^(-1) equiv 2^(3-2) equiv 2(mod 3)$

(2) $gcd(a,m)=4$，不是

(3) $gcd(a,m)=1$，是，$7$ 是素数，由费马小定理的推论 $18^(-1) equiv 18^5 equiv 4^5 equiv 2(mod 7)$

(4) $gcd(a,m)=3$，不是

(5) $gcd(a,m)=1$，是，$9$ 不是素数，即解 $5 x equiv 1(mod 9)$，则 $5^(-1) equiv 2(mod 9)$


(6) $gcd(a,m)=1$，是，$9$ 不是素数，即解 $-x equiv 1(mod 9)$，则 $(-1)^(-1) equiv 8(mod 9)$
#v(2em)
4.45 用费马小定理计算下列各式

#h(2em) (1) $2^325 (mod 5)$

#h(2em) (2) $3^516 (mod 7)$

#h(2em) (3) $8^1003 (mod 11)$

解：

(1) $2^4 equiv 1(mod 5),2^324 equiv 1(mod 5),2^325 equiv 2(mod 5)$

(2) $3^6 equiv 1(mod 7),3^516 equiv 1(mod 7)$

(3) $8^10 equiv 1(mod 11),8^1000 equiv 1(mod 11),8^1003 equiv 8^3 equiv 6(mod 11)$

#v(4em)
== 模块2：图论  
#v(2em)
=== 一·基本概念
#v(1em)

1.无序积：设A，B为任意两集合，则 ${{a,b}|a in A,b in B}$ 为A，B的无序积，记作 $A amp B$
无序对${a,b}$也可记作$(a,b)$，且允许$a=b$，并且任意a,b，均有$(a,b)=(b,a)$，即$A amp B=B amp A$

2.无向图$G$：是一个有序的二元组$<V,E>$，其中（1）$V$是一个非空有穷集（顶点集），其元素称作顶点或结点（2）$E$是无序积$V amp V$的有穷多重子集（边集），元素称作无向边，简称边

3.有向图$D$：是一个有序的二元组$<V,E>$，其中（1）$V$是一个非空有穷集（顶点集），其元素称作顶点或结点（2）$E$是笛卡尔积$V*V$的有穷多重子集（边集），元素称作有向边，简称边

4.图（$G$）：无向图（$G$）+有向图（$D$），但有时专指无向图；$V(G),E(G)$分别表示$G$的顶点集和边集，$abs(V(G))$表示顶点数，其余类似

5.阶：$abs(V(G))=n #sym.arrow.l.r.double.long n$阶图

6.零图：$E(G)=0$，$n$阶零图记作$N_n$,$N_1$称作平凡图

7.空图（$#sym.emptyset$）：$abs(V(G))=0$

8.标定图：用图形表示图时，如果给每一个顶点和每一条边指定一个符号（字母或数字，当然字母还可以带下标）

9.基图：有向图的各条有向边改成无向边后所得到的无向图称作这个有向图的基图

10.关联： 设$G=⟨V,E⟩$为无向图，$e_k =(v_i,v_j)∈E$，称 $v_i,v_j$ 为$e_k$ 的端点，$e_k$ 与$v_i（v_j）$关联. 若$v_i #sym.eq.not v_j$，则 称 $e_k$ 与$v_i（v_j）$的关联次数为1；若$v_i #sym.eq v_j$，则称$e_k$ 与$v_i$ 的关联次数为2，并称$e_k$ 为环. 如果顶点$v_l$不与边$e_k$关联，那么称$e_k$与$v_l$的关联次数为0

11.相邻：对无向图，若两个顶点之间有一条边连接，则称这两个顶点相邻. 若两条边至少有一个公共端点，则称这两条边相邻；对有向图，若两个顶点之间有一条有向边，则称这两个顶点相邻.若两条边中一条边的终点是另一条边的始点，则称这两条边相邻

12.设 $D=⟨V,E⟩$为有向图，$e_k =⟨v_i,v_j⟩ ∈ E$，称 $v_i,v_j$ 为$e_k$ 的端点，$v_i$ 为$e_k$ 的始点，$v_j$ 为$e_k$ 的终点，并称 $e_k$ 与$v_i（v_j）$关联. 若$v_i =v_j$，则称$e_k$ 为$D$中的环

13.孤立点：图（无向的或有向的）中没有边关联的顶点

14.邻域：设无向图$G=<V,E>$，对任意的$v #sym.in V$，称$N_G (v)={u|u #sym.in V,(u,v) #sym.in E,u #sym.eq.not v}$为$v$的邻域；称$overline(N)_G (v)=N_G (v) union {v}$称为$v$的闭邻域；称$I_G (v)={e|e in E,e text("与") v text("相关联")}$为$v$的关联集

15.后继元集：设有向图$D=<V,E>$，任意$v in V$，称$Gamma_D^+(v)={u|u in V,<v,u> in E,u #sym.eq.not v}$为$v$的后继元集；称$Gamma_D^-(v)={u|u in V,<u,v> in E,u #sym.eq.not v}$为$v$的先驱元集；称$N_D (v)=Gamma_D^+(v) union Gamma_D^-(v)$为$v$的邻域；称$overline(N)_D (v)=N_D (v) union {v}$为$v$的闭邻域

16.平行边：无向图中，若关联一对顶点的无向边多于1条，则称这些边，平行边条数称为重数；有向图中，还需要始点与终点相同，则称。含平行边的图称作多重图，既不含平行边也不含环的图称作简单图。

17.子图：设$G=<V,E>,G'=<V',E'>$为两个图（同为无向或有向），若$V' #sym.subset.eq V,E' #sym.subset.eq E$，则有子图与母图，记作$G' #sym.subset.eq G$。类似的，有真子图。若$V'=V$，则有生成子图。设$G=<V,E>,V_1 #sym.subset V,V_1 #sym.eq.not #sym.emptyset$，称以$V_1$为顶点集，以$G$中两个端点都在$V_1$中的边组成的边集$E_1$的图为$G$的$V_1$导出的子图，记作$G[E_1]$；$E_1$导出的子图记作$G[E_1]$，同理

18.设$G=<V,E>$为无向图。

（1）设$e in E$，用$G-e$表示从$G$中去掉边$e$，称作删除边$e$。又设$E' #sym.subset E$，用$G-E'$表示删除这些边 \
（2）设$v in V$，用$G-v$表示从$G$中去掉$v$#strong(text(red)[及所关联的一切边])，称作删除顶点$v$。又设$V' #sym.subset V$，从$G$中删除$V'$中所有的顶点，称作删除$V'$ \
（3）设$e=(u,v) in G$，用$G\\e$表示从$G$中删除$e$后，将$e$的两个端点$u,v$用一个新的顶点$w$代替，并使$w$关联除了$e$之外$u,v$关联的所有边，称作边$e$的收缩 \
（4）设$u,v in V$（$u,v$可能相邻，也可能并不），用$G union (u,v) || G+(u,v)$表示在$u,v$之间加新边

在收缩边和加新边过程中可能产生环和平行边.

19.设$G_1=<V_1,E_1>,G_2=<V_2,E_2>$为不含孤立点的两个图（它们同为无向图或同为有向图）

（1）称以$V_1 union V_2$为顶点集，以$E_1 union E_2$为边集的图为并图，记作$G_1 union G_2=<V_1 union V_2,E_1 union E_2>$\
（2）称以$E_1-E_2$为边集，以$E_1-E_2$ 中边关联的顶点组成的集合为顶点集的图为$G_1$与$G_2$的差图，记作$G_1-G_2$
#v(2em)\
（3）称以$E_1 inter E_2$为边集，以$E_1 inter E_2$ 中边关联的顶点组成的集合为顶点集的图为$G_1$与$G_2$的交图，记作$G_1 inter G_2$\
（4）称以$E_1 #sym.plus.circle E_2$为边集，以$E_1 #sym.plus.circle E_2$中边关联的顶点组成的集合为顶点集的图为$G_1$与$G_2$的环和，记作$G_1 #sym.plus.circle G_2$\
（5）环和即不交并集，$G_1 #sym.plus.circle G_2=(G_1 union G_2)-(G_1 inter G_2)$\
（6）若两个图顶点集不交，称这两个图不交；若边集不交，称作边不交

20.度数：设$G=<V,E>$，为无向图，任意$v in V$，将$v$作为边的端点的次数称作$v$的度数，简称为度，记作$d_G (v)$。在不产生混淆时亦可记作$d(v)$；设$D=<V,E>$为有向图，任意$v in V$，将$v$作为边的始点的次数称为$v$的出度，记作$d_D^+(v)$，简记作$d^+ (v)$；同理，有入度$d_D^-(v)$，简单记作$d^-(v)$，称$v$的度数$d_D (v)=d^+(v)+d^-(v)$（或简单记作$d(v)$）

21.最大（小）度：在无向图$G$中，令$Delta(G)=max{d(v)|v in V(G)},delta(G)=min{d(v)|v in V(G)}$，分别称作$G$的最大度与最小度。类似的，有向图有$Delta(D),delta(D),Delta^+(D),delta^+(D),Delta^-(D),delta^-(D)$，如需简记，去掉$(D)$即可

22.悬挂顶点（边）：度数为1（与之关联）\
奇（偶）度顶点：度数为奇数（偶数）

23.度数列：设$G=<V,E>$为一个$n$阶无向图，$V={v_1,v_2,...,v_n}$，称$d(v_1),d(v_2),...,d(v_n)$；对于顶点标定的无向图，它的度数列唯一。反之，对于给定的非负整数列$d=(d_1,d_2,...,d_n)$，若存在以$V={v_1,v_2,...,v_n}$为顶点集的$n$阶无向图$G$，使得$d(v_i)=d_i,i=1,2,...,n$，则称$d$是可图化的。特别的，若得到的图是简单图，则称可简单图化。对有向图还有类似的出度列和入度列。

#v(2em)
=== 二·公式定理
#v(1em)
1.握手定理：在任何无向图中，所有顶点度数之和等于边数的2倍；在任何有向图中，所有顶点的度数之和等于边数的2倍，所有顶点的入度之和等于所有顶点的出度之和，都等于边数

2.握手定理的推论：任何图中，奇度顶点个数是偶数

证：设图$G=<V,E>$，令$V_1={v|v in V,d(v)text("为奇数")}$，$V_2={v|v in V,d(v)text("为偶数")}$，则$V_1 union V_2=V,V_1 inter V_2=emptyset$。由握手定理，$2 m=sum_(v in V)d(v)$，那么由于偶+（）=偶，奇$*$（）=偶，故$abs(V_1)$必为偶数。

3.非负整数列$d=(d_1,d_2,...,d_n)$可图化$#sym.arrow.l.r.double sum_(i=1)^n d_i$为偶数

证：由握手定理，$#sym.arrow.r.double$显然；对于$#sym.arrow.l.double$，由已知可知，$d$中有$2 k$个奇数，其中$0<=k<=[n/2]$。不妨设它们为$d_1,d_2,...,d_k,...,d_(2k)$。如下构造以$d$为度数列的$n$阶无向图$G=<V,E>:V={v_1,v_2,...,v_n}$，在点$v_r,v_(r+k)$之间连边，$r=1,2,...,k$。若$d_i$为偶数，令$d_i^'=d_i$；若$d_i$为奇数，令$d_i^'=d_i-1$，得$d'=(d_1^',d_2^',...,d_n^')$，则$d_i^'$均为偶数。再在$v_i$处画$d_i^'/2$条环，$i=1,2,...,n$。这就证明了$d$是可图化的。

4.设$G$为任意$n$阶无向简单图，则$Delta(G)<=n-1$。
#v(2em)
=== 三·精选例题
#v(1em)

1.（1）给定无向图$G=<V,E>$，其中$V={v_1,v_2,v_3,v_4,v_5}$ $E={(v_1,v_1),(v_1,v_2),(v_2,v_3),(v_2,v_3),(v_2,v_5),(v_1,v_5),(v_4,v_5)}$

（2）给定有向图$D=<V,E>$，其中$V={a,b,c,d}$ $E={<a,a>,<a,b>,<a,b>,<a,d>,<d,c>,<c,d>,<c,b>}$

画出$G,D$的图形

解：#image("assets/有向图与无向图.png")

2.判断下列非负整数列哪些可图化，哪些可简单图化？

（1）$(5,5,4,4,2,1)$

（2）$(5,4,3,2,2)$

（3）$(3,3,3,1)$

（4）$(d_1,d_2,...,d_n),d_1>d_2>...>d_n>=1$且$sum_(i=1)^n d_i$为偶数

（5）(4,4,3,3,2,2)

解：

（1）否

（2）可图化；否；因为假设可，由定理4$Delta(G)<=5-1=4$，而原列最大度是5

（3）可图化；否；因为假设可，设$G=<V,E>$以$(3,3,3,1)$为度数列，不妨设$V={v_1,v_2,v_3,v_4},d(v_1)=d(v_2)=d(v_3)=3,d(v_4)=1$，由于$d(v_4)=1$，因而$v_4$只能与$v_1,v_2,v_3$之一相邻，不妨设与$v_1$相邻，于是$v_2$只能与$v_1,v_3$相邻，$v_3$只能与$v_1,v_2$相邻，不可能有3度，故不可

（4）可图化；否；因为假设可，由定理4$Delta(G)<=n-1$，而$d_1>=n$，故不可简单图化

（5）可图化；可，举一例即可